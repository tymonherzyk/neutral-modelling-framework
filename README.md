# neutral-modelling-framework
## Introduction
This framework was developed to facilitate the research presented in the thesis: "Towards a general theory within wastewater treatment: computational and experimental examples utilising fundamental laws to describe microbial community structure in wastewater treatment systems" written by Tymon Alexander Herzyk, submitted in fulfilment of the requirements for the Degree of Doctor of Philosophy in Civil Engineering, at the School of Engineering, College of Science and Engineering, University of Glasgow. The framework developed is shared here under the Creative Commons Attribution 4.0 International License (CC-BY) to offer transparency and allow others to make use of the framework developed for further research.

The framework was tasked with producing relative abundance time series under different sampling regimes from differing sets of community structuring processes and with facilitating the calibration of common neutral models to these data sets with the purpose of producing estimates for distinct model parameters. The framework is split into three packages to achieve this:
* __Simulation__ - simulates a relative abundance time series of a single species within a community using a chosen model.
* __Sampling__ - samples single species relative abundace time series for a period and frequency chosen by the user.
* __Fitting__ - fits a chosen model to single species relative abundace time series using maximum likelihood estimation to provide estimate of distinct model parameters.

Code for each of these packages is provided in respective folders and descriptions of how each package operates is provided in relative README.md files. Instalation, user and developer guides are provided in the Guides folder. All scripts and functions within these packages were written using MATLAB version R2020b in accordance with the academic license provided by the University of Glasgow.

## Framework architecture
The figure below lays out the overall architecture of the framework developed. The three dashed boxes indicate the remit of each package, the primary executable for each package is highlighted in the centre of these boxes. Pathways or files outwith the dashed boxes represent areas where user interaction is required. The movement of information within the framework is depicted using solid arrows, file names and types are indicated by coloured tags and key variables are portrayed through relevant abbreviations contained in clear tags. User input variables, required for the operation of each package, are stored in associated spreadsheets, these are represented by files simulationParameters.xlsx, samplingParameters.xlsx and fittingParameters.xlsx.

![Framework_architecture (1)](https://github.com/user-attachments/assets/5fcf3323-41d9-4483-b926-fe622b419e0a)


Execution of a package is undertaken by running its respective primary script. These are files simulation.m, sampling.m and fitting.m. The first task of these scripts is to load associated input variables from their corresponding sheet within each package spreadsheet (this process is marked as 1). For both sampling.m and fitting.m data files are also required, the user is prompted to select these files when the associated script is executed (this process is marked as 2). Once input variables and data files have been successfully imported, the functionality of the package is delegated to the relevant function (this process marked as 2, and 3 respectivley). The choice of function is demonstrated through the "or" operator within each package. The number of times a function is run is represented by a circular arrow, with the variable govenrning this highlighted. Functions load required input variables from the associated package spreadsheet, only the sheet pertaining to the function called is accessed. After execution of the relevant function variables are passed back to the primary script to be saved (this process is marked as 3 and 4 respectivley).

The compartmentalisation of the code into separate packages within this framework allows users to tailor workflows as required. For example, data obtained from the simulation package can be further processed through the sampling package or passed directly to the fitting package. The segregation of package functionality acts to disentangle dependencies between portions of code and allows for standalone development of function files. Indeed, new functionality can be added entirely independent of the current functionality. The partitioning of input variables also promotes independence across functions and by only loading specific sheets, errors resulting from the crossover of variables are negated. The architecture of the framework has been engineered with usability and adaptability at the fore of the development process. \\
